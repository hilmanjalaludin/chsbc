<?php/* * E.U.I  *  * subject	: get SetCampaign modul  * 			  extends under EUI_Controller class * author   : razaki team	 * link		: http://www.razakitechnology.com/eui/model/sysuser/ */ class M_SetCmpAssignCmp extends EUI_Model{/* * EUI :: _get_default()  * ----------------------------------------- * * @ def		function get detail content list page  * @ param		not assign parameter */	 function _get_campaign_name(){	$datas = array();	$sql = " SELECT a.CampaignId, a.CampaignName FROM t_gn_campaign a WHERE a.CampaignStatusFlag=1 ";	$qry = $this -> db -> query($sql);	foreach( $qry -> result_assoc() as $rows ){		$datas[$rows['CampaignId']] = $rows['CampaignName'];	}		return $datas;}/* * EUI :: _get_default()  * ----------------------------------------- * * @ def		function get detail content list page  * @ param		not assign parameter */	 function _get_default(){	$this -> EUI_Page -> _setPage(20); 	$this -> EUI_Page -> _setQuery		(			" select c.DIDName, c.DIDNumber as CampaignTelephoneNumber, concat(b.CampaignNumber,'-',b.CampaignName) as CampaignOutbondName			from t_gn_campaign_transaction a			left join t_gn_campaign b ON a.CampaignId=b.CampaignId			left join t_lk_campaign_did c ON c.Id=a.DIDCampaign "  		); 		// set filter 		$filter = '';	$this -> EUI_Page -> _setWhere($filter);   				return $this -> EUI_Page;}/* * EUI :: _get_content()  * ----------------------------------------- * * @ def		function get detail content list page  * @ param		not assign parameter */		 function _get_content(){	$this -> EUI_Page -> _postPage( $this -> URI -> _get_post('v_page') );	$this -> EUI_Page -> _setPage(20);		$this -> EUI_Page -> _setQuery	(	   " select c.DIDName, c.DIDNumber as CampaignTelephoneNumber, concat(b.CampaignNumber,'-',b.CampaignName) as CampaignOutbondName			from t_gn_campaign_transaction a			left join t_gn_campaign b ON a.CampaignId=b.CampaignId			left join t_lk_campaign_did c ON c.Id=a.DIDCampaign " 	 );	 	 // set filtering 		$filter = null;		if( $this -> URI -> _get_have_post('order_by') ) 		$this -> EUI_Page -> _setOrderBy( $this -> URI -> _get_post('order_by'),$this -> URI -> _get_post('type'));				$this -> EUI_Page ->  _setLimit();}	/* * EUI :: _get_resource_query()  * ----------------------------------------- * * @ def		function get detail content list page  * @ param		not assign parameter */ function _get_resource_query() {	$res = false;	self::_get_content();	if( $this -> EUI_Page -> _get_query()!='') {		$res = $this -> EUI_Page -> _result();		if($res) return $res;	}	 } /* * EUI :: _get_page_number()  * ----------------------------------------- * * @ def		function get detail content list page  * @ param		not assign parameter */ function _get_page_number()  {	if( $this -> EUI_Page -> _get_query()!='' )	{		return $this -> EUI_Page -> _getNo();	}	  }     /* * EUI :: _get_page_number()  * ----------------------------------------- * * @ def		function get detail content list page  * @ param		not assign parameter */  function _set_save_campaign( $post=array() ) {	$_conds = false;	$_serialize = $this -> URI -> _get_all_request();	$_productid = $this -> URI -> _get_array_post('SelectProductId');		$sql = array		(			'CategoryId' 			=> (isset($_serialize['CategoryId'])?$_serialize['CategoryId']:null), 			'OutboundGoalsId' 		=> (isset($_serialize['OutboundGoalsId'])?$_serialize['OutboundGoalsId']:null), 			'CampaignNumber' 		=> (isset($_serialize['CampaignNumber'])?$_serialize['CampaignNumber']:null), 			'CampaignName' 			=> (isset($_serialize['CampaignName'])?$_serialize['CampaignName']:null), 			'CampaignStatusFlag' 	=> (isset($_serialize['StatusActive'])?$_serialize['StatusActive']:null),			'DirectMethod' 			=> (isset($_serialize['DirectMethod'])?$_serialize['DirectMethod']:null),			'DirectAction' 			=> (isset($_serialize['DirectAction'])?$_serialize['DirectAction']:null),			'AvailCampaignId' 		=> (isset($_serialize['AvailCampaignId'])?$_serialize['AvailCampaignId']:null),			'CampaignEndDate' 		=> (isset($_serialize['ExpiredDate'])?$this->EUI_Tools->_date_english($_serialize['ExpiredDate']):null), 			'CampaignStartDate' 	=> $this -> EUI_Tools -> _date_time()		);		if( $this -> db -> insert('t_gn_campaign',$sql)){		$_insertId = $this -> db -> insert_id();		if( $_insertId )		{			if(isset($_productid))			{					foreach($_productid as $k => $ProductId)				{					if( $this -> db -> insert('t_gn_campaignproduct',						array(						 'CampaignId' => $_insertId, 						 'ProductId' =>$ProductId )					))					{						$_conds+=1;					}					}			}		}	}		return $_conds;		 }  /* * EUI :: _get_page_number()  * ----------------------------------------- * * @ def		function get detail content list page  * @ param		not assign parameter */function _get_size_campaign(){ 	$_conds = array();		$sql = " SELECT COUNT(a.CustomerId) as SizeCount, a.CampaignId FROM t_gn_customer a GROUP BY a.CampaignId ";	$qry = $this->db->query($sql);	foreach($qry -> result_assoc() as $rows ) {		$_conds[$rows['CampaignId']] = ( $rows['SizeCount'] ? $rows['SizeCount'] : 0 );		}		return $_conds;}	/* * EUI :: _get_page_number()  * ----------------------------------------- * * @ def		function get detail content list page  * @ param		not assign parameter */function getAttribute($CampaignId=null ){	$_conds = array();	if( isset($_conds))	{		$sql = "SELECT * FROM (`t_gn_campaign`) WHERE `CampaignId` = '$CampaignId'";		$qry = $this -> db -> query($sql);				if($qry !=FALSE) 		{			$_conds = $qry -> result_first_assoc();		}		}		return $_conds;}/* * EUI :: _get_page_number()  * ----------------------------------------- * * @ def		function get detail content list page  * @ param		not assign parameter */function _setUpdate($_post_data= null){	$_conds = false;	if(!is_null($_post_data))	{		if( $this ->db -> update("t_gn_campaign",array		(			"CampaignName" => $_post_data['CampaignName'],			"CategoryId" => $_post_data['CategoryId'],			"OutboundGoalsId" => $_post_data['OutboundGoalsId'],			"CampaignEndDate" => $this -> EUI_Tools -> _date_english($_post_data['ExpiredDate']),			"DirectMethod" => $_post_data['DirectMethod'],			"DirectAction" => $_post_data['DirectAction'],			"AvailCampaignId" => $_post_data['AvailCampaignId'],			"CampaignStatusFlag" => $_post_data['StatusActive'] 		), array("CampaignId"=> $_post_data['CampaignId'])		)){			$_conds =true;		} 	}		return $_conds;}/* * EUI :: _get_page_number()  * ----------------------------------------- * * @ def		function get detail content list page  * @ param		not assign parameter */ function _getDataCampaignId($CampaignId = array()){	$_conds = array();	$this -> db -> select	(		"a.CustomerNumber, a.CustomerFirstName,		 a.CustomerLastName, a.CustomerDOB,		 a.CustomerIdentificationNum, a.CustomerAddressLine1,		 a.CustomerAddressLine2, a.CustomerAddressLine3,	     a.CustomerAddressLine4, a.CustomerCity,		 a.CustomerZipCode, a.CustomerHomePhoneNum,		 a.CustomerMobilePhoneNum, a.CustomerWorkFaxNum,		 a.CustomerWorkExtPhoneNum, a.CustomerWorkPhoneNum,		 a.CustomerFaxNum, a.CustomerEmail,		 a.CustomerOfficeName, a.CustomerOfficeLine1,		 a.CustomerOfficeLine2, a.CustomerOfficeLine3,		 a.CustomerOfficeLine4, a.CustomerOfficeCity,		 a.CustomerOfficeZipCode,a.CustomerArea,		 a.CustomerUploadedTs, a.CustomerCcNumber,		 b.CampaignName"	);		$this -> db -> from("t_gn_customer a");	$this -> db -> join("t_gn_campaign b ","a.CampaignId=b.CampaignId","LEFT");	$this -> db -> where_in("a.CampaignId",$CampaignId);		$i = 0;	foreach( $this -> db -> get() -> result_assoc() as $rows )	{		foreach($rows as $fields => $values ) {			$_conds[$i][$fields] = $values;		}			$i++;	}		return $_conds;}/* * EUI :: _getMethodDirection()  * ----------------------------------------- * * @ def		function get detail content list page  * @ param		not assign parameter */  function _getMethodDirection() {	$_conds = array();		$this->db->select('a.MethodCode, a.MethodName'); 	$this->db->from('t_lk_direct_method a');	$this->db->where('a.MenthodFlags',1);		foreach( $this ->db->get()->result_assoc() as $rows)	{		$_conds[$rows['MethodCode']] = $rows['MethodName'];	}		return $_conds;		 } /* * EUI :: _getMethodDirection()  * ----------------------------------------- * * @ def		function get detail content list page  * @ param		not assign parameter */  function _getMethodAction() {	$_conds = array();		$this->db->select('a.ActionCode, a.ActionName'); 	$this->db->from('t_lk_direction_action a');	$this->db->where('a.ActionFlags',1);		foreach( $this ->db->get()->result_assoc() as $rows)	{		$_conds[$rows['ActionCode']] = $rows['ActionName'];	}		return $_conds; } /** EUI :: _getIVRPhoneNo() * -----------------------------------------*/		function _getIVRPhoneNo()	{		$_conds = array();				$this->db->select('a.DIDName, a.DIDNumber'); 		$this->db->from('t_lk_campaign_did a');		foreach( $this ->db->get()->result_assoc() as $rows)		{			$_conds[$rows['DIDName']] = $rows['DIDName'];		}		return $_conds;	}  /* * EUI :: _getOutboundGoals()  * ----------------------------------------- * * @ def		function get detail content list page  * @ param		not assign parameter */  function _getCampaignGoals( $OutboundGoalsId = 0 ) {	$_conds = array();		$this->db->select('a.CampaignId, a.CampaignName');	$this->db->from('t_gn_campaign a');	$this->db->where('a.OutboundGoalsId', $OutboundGoalsId);	foreach( $this ->db->get()->result_assoc() as $rows)	{		$_conds[$rows['CampaignId']] = $rows['CampaignName'];	}		return $_conds;	 }  }?>