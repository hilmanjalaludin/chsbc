/*
 * Script Compressor v1.2.0 
 
 * ---------------------------------------------------------------------------------
 * Copyright (c) 2015 http://razakitechnology.com/application
 * generator compress javascript to minimize script production
 * and GPL licenses.
 * ----------------------------------------------------------------------------------
 
 * @ Depends	:	EUI.CTIScript.js
 * @ Date		:	2/23/2016
 * @ Author		:	razaki development team
 * @ Email		:	jombi_par@yahoo.com
 *
 */

var isMSIE=(Ext.Browser().getName()=="Microsoft Internet Explorer");var CBTNALL=65535;var CBTNREADY=1;var CBTNAUX=2;var CBTNACW=4;var CBTNPREDICTIVE=16;var CBTNOUTBOUND=8;var CBTNDIAL=256;var CBTNHOLD=512;var CBTNHANGUP=1024;var CBTNTRANSFER=2048;var CBTNCONFERENCE=4096;var AGENT_NULL=0;var AGENT_LOGIN=1;var AGENT_READY=2;var AGENT_NOTREADY=3;var AGENT_ACW=4;var AGENT_OUTBOUND=5;var AGENT_PREDICTIVE=6;var AGENT_BUSY=7;var CALLSTATUS_IDLE=0;var CALLSTATUS_ALERTING=1;var CALLSTATUS_CONNECTED=2;var CALLSTATUS_SERVICEINITIATED=3;var CALLSTATUS_ANSWERED=4;var CALLSTATUS_HELD=5;var CALLSTATUS_ORIGINATING=6;var CALLSTATUS_TRUNKSEIZED=7;var INBOUND_CALL=1;var OUTBOUND_CALL=2;var EMAIL_MEDIA=1;var onHold=false;var onCall=false;var connectedStatus=false;var agentStatus=AGENT_NULL;var agentBtnState=0;var callBtnState=0;var callStatus=0;var warned=0;var destNo;var callPasswd;var callTAC;var promptDestWin=undefined;var CTI={call_tac:0,user_level:0,init:function(a,b){this.call_tac=a;this.user_level=b},prepareCTIClient:function(){try{if(document.ctiapplet.getAgentStatus()==Ext.DOM.AGENT_NULL){document.ctiapplet.setAgentSkill(1);document.ctiapplet.ctiConnect();document.ctiapplet.setAgentEventHandler("CTI.OnAgentEventHandler");document.ctiapplet.setCallEventHandler("CTI.OnCallEventHandler");document.ctiapplet.setOtherMediaEventHandler("CTI.OnOtherMediaEventHandler")}if(isMSIE){document.ctiapplet.style.display="none"}}catch(a){Ext.Error({log:a,name:"CTI.prepareCTIClient()",lineNumber:a.lineNumber})}},prepareDisconnect:function(){document.ctiapplet.ctiDisconnect()},dialOut:function(a){callTAC=this.call_tac;if(a.indexOf(callTAC)==0){a=a.substring(callTAC.length)}document.ctiapplet.callDial(callTAC,a,"1234")},timeStamp:function(){var a=new Date();var b=a.getFullYear()+"/"+(a.getMonth()+1)+"/"+a.getDate()+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds();return b},disableAgentButton:function(a){document.getElementById("idFrmAgent").btnReady.disabled=(a&CBTNREADY);document.frmAgent.btnReady.disabled=(a&CBTNREADY);document.frmAgent.btnAUX.disabled=(a&CBTNAUX)},disableCallButton:function(a){callBtnState|=a;document.frmAgent.btnHold.disabled=(callBtnState&CBTNHOLD);document.frmAgent.btnHangup.disabled=(callBtnState&CBTNHANGUP)},enableCallButton:function(a){callBtnState&=~a;if(!onCall){document.frmAgent.btnDial.disabled=(callBtnState&CBTNDIAL)}document.frmAgent.btnHold.disabled=(callBtnState&CBTNHOLD);document.frmAgent.btnHangup.disabled=(callBtnState&CBTNHANGUP)},disableAllButton:function(){},OnLeaveInbound:function(){return(Ext.Ajax({url:Ext.DOM.INDEX+"/CallGroupTeam/index/",method:"POST",param:{time:Ext.Date().getDuration()}}).json())},OnAgentEventHandler:function(b){switch(b){case AGENT_LOGIN:Ext.Cmp("AgentStatus").setText('" Login');break;case AGENT_READY:Ext.Cmp("AgentStatus").setText('" Ready');break;case AGENT_NOTREADY:var a=Ext.Cmp("auxReason").getElementId();if((Ext.Cmp("auxReason").getText()!="")){if(Ext.Cmp("auxReason").getValue()!=""){Ext.Cmp("AgentStatus").setText("Not Ready [ "+Ext.Cmp("auxReason").getText()+" ]")}else{Ext.Cmp("AgentStatus").setText("Not Ready")}}else{Ext.Cmp("AgentStatus").setText('" Not Ready')}break;case AGENT_ACW:Ext.Cmp("AgentStatus").setText('" Acw');break;case AGENT_OUTBOUND:Ext.Cmp("AgentStatus").setText('" Busy');break;case AGENT_PREDICTIVE:break;case AGENT_BUSY:Ext.Cmp("AgentStatus").setText('" Busy');break;default:if(warned==0){Ext.Msg("Login Telephony anda ditolak karena kemungkinanan anda sudah login ditempat lain\natau sudah ada yang login di PC ini").Info();warned=1;Ext.Cmp("AgentStatus").setText('" Reject')}break}},OnCallEventHandler:function(a){switch(a){case CALLSTATUS_IDLE:onHold=false;onCall=false;Ext.Cmp("idCallStatus").setText("Idle");break;case CALLSTATUS_ALERTING:onCall=true;console.log("CALLSTATUS_ALERTING="+CALLSTATUS_ALERTING);if(document.ctiapplet.getCallDirection()==INBOUND_CALL){Ext.Cmp("idCallStatus").setText("Call Inbound from "+document.ctiapplet.getCallerId());try{Ext.CallerScript()}catch(b){console.log(b)}Ext.ShowMenu("CallerIncoming","New Call",{callerid:document.ctiapplet.getCallerId(),callsessionid:document.ctiapplet.getCallSessionKey(),ivrdata:document.ctiapplet.getIVRData()})}if(document.ctiapplet.getCallDirection()==OUTBOUND_CALL){try{Ext.Cmp("idCallStatus").setText("Call to "+document.ctiapplet.getCallerId())}catch(b){Ext.Error({log:b,name:"CTI.Call Status=> "+CALLSTATUS_ALERTING,lineNumber:b.lineNumber})}}break;case CALLSTATUS_ANSWERED:console.log("CALLSTATUS_ANSWERED "+CALLSTATUS_ANSWERED);onCall=true;if(document.ctiapplet.getCallDirection()==INBOUND_CALL){Ext.Cmp("idCallStatus").setText("Call to "+document.ctiapplet.getCallerId())}else{if(document.ctiapplet.getCallDirection()==OUTBOUND_CALL){try{Ext.Cmp("idCallStatus").setText("Call to "+ExtApplet.getPhoneNumber())}catch(b){Ext.Error({log:b,name:"CTI.Call Status=> "+CALLSTATUS_ANSWERED,lineNumber:b.lineNumber})}}}break;case CALLSTATUS_SERVICEINITIATED:onCall=true;Ext.Cmp("idCallStatus").setText("Phone offhook");break;case CALLSTATUS_ORIGINATING:console.log("CALLSTATUS_ORIGINATING "+CALLSTATUS_ORIGINATING);onCall=true;if(document.ctiapplet.getCallDirection()==INBOUND_CALL){}if(document.ctiapplet.getCallDirection()==OUTBOUND_CALL){try{Ext.Cmp("idCallStatus").setText("Connected to - "+ExtApplet.getPhoneNumber())}catch(b){Ext.Error({log:b,name:"CTI.Call Status=> "+CALLSTATUS_ORIGINATING,lineNumber:b.lineNumber})}}break;case CALLSTATUS_CONNECTED:console.log("CALLSTATUS_CONNECTED "+CALLSTATUS_CONNECTED);onCall=true;onHold=false;if(document.ctiapplet.getCallDirection()==INBOUND_CALL){Ext.Cmp("idCallStatus").setText("Call from "+document.ctiapplet.getCallerId()+" connected")}if(document.ctiapplet.getCallDirection()==OUTBOUND_CALL){try{Ext.Cmp("idCallStatus").setText("Connected to - "+ExtApplet.getPhoneNumber())}catch(b){Ext.Error({log:b,name:"CTI.Call Status=> "+CALLSTATUS_CONNECTED,lineNumber:b.lineNumber})}}break;case CALLSTATUS_HELD:onHold=true;Ext.Cmp("idCallStatus").setText("Call with "+ExtApplet.getPhoneNumber()+" on hold");break}},OnOtherMediaEventHandler:function(b,a){switch(b){case EMAIL_MEDIA:(parent.frames[0]!="undefined"?parent.frames[0].cti_notification(1,document.ctiapplet.getMediaId()):"");break}},onButtonHoldClick:function(){if(onHold){document.ctiapplet.callRetrieve()}else{document.ctiapplet.callHold()}},setLabelStatus:function(b){if(b!=""){Ext.Cmp("idCallStatus").setText(Ext.Cmp("auxReason").getText());if(Ext.Cmp("auxReason").empty()!=true){try{document.ctiapplet.agentSetNotReady(b)}catch(a){Ext.Cmp("AgentStatus").setText("ERR CTI Applet");window.setTimeout(function(){Ext.Cmp("AgentStatus").setText("AGENT_STATUS")},2000);Ext.Error({log:a,name:"CTI.agentSetNotReady()",lineNumber:a.lineNumber})}}else{try{document.ctiapplet.agentSetNotReady(0)}catch(a){Ext.Error({log:a,name:"CTI.agentSetNotReady()",lineNumber:a.lineNumber})}}return false}else{return}},setLabelReady:function(){try{Ext.Cmp("idCallStatus").setText("Idle");if((document.ctiapplet.getAgentStatus()!=AGENT_READY)){document.ctiapplet.agentSetReady();return false}}catch(a){Ext.Cmp("idCallStatus").setText("ERR CTI Applet");window.setTimeout(function(){Ext.Cmp("idCallStatus").setText("-")},2000);Ext.Error({log:a,name:"CTI.setLabelReady()",lineNumber:a.lineNumber})}},ctiSetTicketNumber:function(a){document.ctiapplet.setAssignmentId(a)}};
