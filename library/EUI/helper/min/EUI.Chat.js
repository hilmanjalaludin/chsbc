/*
 * Script Compressor v1.2.0 
 
 * ---------------------------------------------------------------------------------
 * Copyright (c) 2015 http://razakitechnology.com/application
 * generator compress javascript to minimize script production
 * and GPL licenses.
 * ----------------------------------------------------------------------------------
 
 * @ Depends	:	EUI.Chat.js
 * @ Date		:	2/23/2016
 * @ Author		:	razaki development team
 * @ Email		:	jombi_par@yahoo.com
 *
 */

var windowFocus=true;var username;var aliasname;var chatHeartbeatCount=0;var minChatHeartbeat=5000;var maxChatHeartbeat=33000;var chatHeartbeatTime=minChatHeartbeat;var originalTitle;var blinkOrder=0;var chatboxFocus=new Array();var newMessages=new Array();var newMessagesWin=new Array();var chatBoxes=new Array();var chattitle=new Array();var eventUser=null;$(function(){eventUser=Ext.EventUrl(["UserChat","index"]).Apply()});$(document).ready(function(){originalTitle=document.title;startChatSession();$([window,document]).blur(function(){windowFocus=false}).focus(function(){windowFocus=true;document.title=originalTitle})});function restructureChatBoxes(){align=0;var b={};for(var a in chatBoxes){chatboxtitle=chatBoxes[a];if($("#chatbox_"+chatboxtitle).css("display")!="none"&&typeof($("#chatbox_"+chatboxtitle).css("display"))!="undefined"){b[chatBoxes[a]]=chatBoxes[a]}}chatBoxes=Object.keys(b);for(x in chatBoxes){chatboxtitle=chatBoxes[x];if($("#chatbox_"+chatboxtitle).css("display")!="none"){if($("#chatbox_"+chatboxtitle).css("display")!="undefined"){if(align==0){$("#chatbox_"+chatboxtitle).css("right","20px")}else{width=(align)*(225+7)+20;$("#chatbox_"+chatboxtitle).css("right",width+"px")}align++}}}}function chatWith(a){var b=new Array();if(typeof(a)=="object"){b=new Array((typeof(a.UserId)=="string"?a.UserId:"0"),(typeof(a.UserName)=="string"?a.UserName:"0"));chattitle=new Array((typeof(a.UserId)=="string"?a.UserId:"0"),(typeof(a.UserName)=="string"?a.UserName:"0"))}if(typeof(b)=="object"){createChatBox(b);$("#chatbox_"+(b[0]?b[0]:"")+" .chatboxtextarea").focus()}}function createChatBox(b,a){if($("#chatbox_"+b[0]).length>0){if($("#chatbox_"+b[0]).css("display")=="none"){$("#chatbox_"+b[0]).css("display","block");restructureChatBoxes()}$("#chatbox_"+b[0]+" .chatboxtextarea").focus();return}$(" <div />").attr("id","chatbox_"+b[0]).addClass("chatbox").html('<div class="chatboxhead ui-corner-top ui-state-default"><span class="chatboxtitle">'+b[0]+'</span>&nbsp;::&nbsp;<span class="chatboxtitle2">'+b[1]+'</span><div class="chatboxoptions"><a href="javascript:void(0)" onclick="javascript:toggleChatBoxGrowth(\''+b[0]+'\')"><b>--</b></a> <a href="javascript:void(0)" onclick="javascript:closeChatBox(\''+b[0]+'\')">X</a></div><br clear="all"/></div><div class="chatboxcontent"></div><span class="chatClear"><a href="javascript:void(0)" onClick="javascript:clearChatReason(\''+b[0]+'\')">Clear All</a></span><div class="chatboxinput"><textarea class="chatboxtextarea" onkeydown="javascript:return checkChatBoxInputKey(event,this,\''+b+"');\"></textarea></div>").appendTo($("body"));$("#chatbox_"+b[0]).css("bottom","37px");chatBoxeslength=0;for(x in chatBoxes){if($("#chatbox_"+chatBoxes[x]).css("display")!="none"){chatBoxeslength++}}if(chatBoxeslength==0){$("#chatbox_"+b[0]).css("right","20px")}else{width=(chatBoxeslength)*(225+7)+20;$("#chatbox_"+b[0]).css("right",width+"px")}chatBoxes.push(b[0]);if(a==1){minimizedChatBoxes=new Array();if($.cookie("chatbox_minimized")){minimizedChatBoxes=$.cookie("chatbox_minimized").split(/\|/)}minimize=0;for(j=0;j<minimizedChatBoxes.length;j++){if(minimizedChatBoxes[j]==b[0]){minimize=1}}if(minimize==1){$("#chatbox_"+b[0]+" .chatboxcontent").css("display","none");$("#chatbox_"+b[0]+" .chatboxinput").css("display","none")}}chatboxFocus[b[0]]=false;$("#chatbox_"+b[0]+" .chatboxtextarea").blur(function(){chatboxFocus[b[0]]=false;$("#chatbox_"+b[0]+" .chatboxtextarea").removeClass("chatboxtextareaselected")}).focus(function(){chatboxFocus[b[0]]=true;newMessages[b[0]]=false;$("#chatbox_"+b[0]+" .chatboxhead .ui-corner-top ui-state-default ").removeClass("chatboxblink");$("#chatbox_"+b[0]+" .chatboxtextarea").addClass("chatboxtextareaselected")});$("#chatbox_"+b[0]).click(function(){if($("#chatbox_"+b[0]+" .chatboxcontent").css("display")!="none"){$("#chatbox_"+b[0]+" .chatboxtextarea").focus()}});$("#chatbox_"+b[0]).show()}function chatHeartbeat(){var c=0;if(windowFocus==false){var b=0;var a=0;for(x in newMessagesWin){if(newMessagesWin[x]==true){++b;if(b>=blinkOrder){document.title=x+" says...";a=1;break}}}if(a==0){document.title=originalTitle;blinkOrder=0}else{++blinkOrder}}else{for(x in newMessagesWin){newMessagesWin[x]=false}}for(x in newMessages){if(newMessages[x]==true){if(chatboxFocus[x]==false){$("#chatbox_"+x+" .chatboxhead").toggleClass("chatboxblink")}}}$.ajax({url:eventUser+"/?action=chatheartbeat",cache:false,dataType:"json",success:function(d){$.each(d.items,function(f,g){if(typeof(g)=="object"){chatboxtitle=g.f;if($("#chatbox_"+chatboxtitle).length<=0){createChatBox(new Array(chatboxtitle,g.g))}if($("#chatbox_"+chatboxtitle).css("display")=="none"){$("#chatbox_"+chatboxtitle).css("display","block");restructureChatBoxes()}if(g.s==1){g.f=username}if(g.s==2){$("#chatbox_"+chatboxtitle+" .chatboxcontent").append('<div class="chatboxmessage"><span class="chatboxinfo">'+g.m+"</span></div>")}else{newMessages[chatboxtitle]=true;newMessagesWin[chatboxtitle]=true;$("#chatbox_"+chatboxtitle+" .chatboxcontent").append('<div class="chatboxmessage"><span class="chatboxmessagefrom"><i>'+g.g+'</i>&nbsp;:&nbsp;&nbsp;</span><span class="chatboxmessagecontent">'+g.m+"</span></div>")}try{$("#chatbox_"+chatboxtitle+" .chatboxcontent").scrollTop($("#chatbox_"+chatboxtitle+" .chatboxcontent")[0].scrollHeight)}catch(h){console.log(h)}c+=1}});chatHeartbeatCount++;if(c>0){chatHeartbeatTime=minChatHeartbeat;chatHeartbeatCount=1}else{if(chatHeartbeatCount>=10){chatHeartbeatTime*=2;chatHeartbeatCount=1;if(chatHeartbeatTime>maxChatHeartbeat){chatHeartbeatTime=maxChatHeartbeat}}}setTimeout("chatHeartbeat();",chatHeartbeatTime)}})}function removeArr(c){var f,d=arguments,b=d.length,e;while(b>1&&c.length){f=d[--b];while((e=c.indexOf(f))!==-1){c.splice(e,1)}}return c}function closeChatBox(b){$("#chatbox_"+b).remove();restructureChatBoxes();var c=new Array();var a="";if($.cookie("chatbox_minimized")){c=$.cookie("chatbox_minimized").split(/\|/)}c=removeArr(c,b);for(i=0;i<c.length;i++){if(c[i]!=""){a+=c[i]+"|"}}a=a.slice(0,-1);$.cookie("chatbox_minimized",a);$.post(eventUser+"/?action=closechat",{chatbox:b},function(d){})}function toggleChatBoxGrowth(b){if($("#chatbox_"+b+" .chatboxcontent").css("display")=="none"){var c=new Array();if($.cookie("chatbox_minimized")){c=$.cookie("chatbox_minimized").split(/\|/)}c=removeArr(c,b);var a="";for(i=0;i<c.length;i++){a+=c[i]+"|"}a=a.slice(0,-1);$.cookie("chatbox_minimized",a);$("#chatbox_"+b+" .chatboxcontent").css("display","block");$("#chatbox_"+b+" .chatboxinput").css("display","block");$("#chatbox_"+b+" .chatClear").css("display","block");$("#chatbox_"+b+" .chatboxcontent").scrollTop($("#chatbox_"+b+" .chatboxcontent")[0].scrollHeight)}else{var a=b;if($.cookie("chatbox_minimized")){a+="|"+$.cookie("chatbox_minimized")}$.cookie("chatbox_minimized",a);$("#chatbox_"+b+" .chatboxcontent").css("display","none");$("#chatbox_"+b+" .chatboxinput").css("display","none");$("#chatbox_"+b+" .chatClear").css("display","none")}}function checkChatBoxInputKey(d,c,e){var e=e.split(",");if(d.keyCode==13&&d.shiftKey==0){message=$(c).val();message=message.replace(/^\s+|\s+$/g,"");$(c).val("");$(c).focus();$(c).css("height","44px");if(message!=""){$.post(eventUser+"/?action=sendchat",{to:e[0],aliasname:e[1],message:message},function(f){message=message.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;");$("#chatbox_"+e[0]+" .chatboxcontent").append('<div class="chatboxmessage"><span class="chatboxmessagefrom">'+aliasname+':&nbsp;&nbsp;</span><span class="chatboxmessagecontent">'+message+"</span></div>");$("#chatbox_"+e[0]+" .chatboxcontent").scrollTop($("#chatbox_"+e[0]+" .chatboxcontent")[0].scrollHeight)})}chatHeartbeatTime=minChatHeartbeat;chatHeartbeatCount=1;return false}var b=c.clientHeight;var a=94;if(a>b){b=Math.max(c.scrollHeight,b);if(a){b=Math.min(a,b)}if(b>c.clientHeight){$(c).css("height",b+8+"px")}}else{$(c).css("overflow","auto")}}function clearChatReason(a){$("#chatbox_"+a+" .chatboxcontent").html("");$.post(eventUser+"/?action=closechat",{chatbox:a},function(b){})}function startChatSession(){$.ajax({url:eventUser+"/?action=startchatsession",cache:false,dataType:"json",success:function(a){username=a.username;aliasname=a.codeuser;$.each(a.items,function(b,c){if(c){chatboxtitle=c.f;if($("#chatbox_"+chatboxtitle).length<=0){createChatBox(new Array(chatboxtitle,c.g),1)}if(c.s==1){c.f=username;c.g=aliasname}if(c.s==2){$("#chatbox_"+chatboxtitle+" .chatboxcontent").append('<div class="chatboxmessage"><span class="chatboxinfo">'+c.m+"</span></div>")}else{$("#chatbox_"+chatboxtitle+" .chatboxcontent").append('<div class="chatboxmessage"><span class="chatboxmessagefrom">'+c.g+':&nbsp;&nbsp;</span><span class="chatboxmessagecontent">'+c.m+"</span></div>")}}});for(i=0;i<chatBoxes.length;i++){chatboxtitle=chatBoxes[i];$("#chatbox_"+chatboxtitle+" .chatboxcontent").scrollTop($("#chatbox_"+chatboxtitle+" .chatboxcontent")[0].scrollHeight);setTimeout('$("#chatbox_"+chatboxtitle+" .chatboxcontent").scrollTop($("#chatbox_"+chatboxtitle+" .chatboxcontent")[0].scrollHeight);',100)}setTimeout("chatHeartbeat();",chatHeartbeatTime)}})};
